# ルール

- コメント、ログ、受け答えは日本語で記述
- ドキュメントも応答も、「です」「ます」を付けない。簡潔に記述
- 特定の作業中に、ルールに則っていないものが見付かれば、同時にリファクタリングを適切に行う
- タスクを依頼されたときは、まずその内容を分析し、そのままの順番でやるのではなく、適切に再構成してTODOリストを作成して進める
- npm run typecheck / npm run lint-fix で必ず最後に確認する
- eslint ignoreをなるべく利用しない。どうしても必要ならかならず `/* eslint-ignore-next-line @foo/bar -- ... */` のように必ず理由をコメントで書くこと。
  - なるべくファイル単位のignoreを利用し、かつそのファイルを小さく分離してignoreする領域を小さくすること。
  - ignoreやanyを利用する対象は必ず `_unsafe_/` というのが間に入るようなディレクトリ配下に入れること。
- Promiseを握り潰さない。 .catchもなるべく利用しない。
  - webならuseMutationを検討せよ。loadingのステートの明示的なハンドリングをせよ。
  - それでも難しければ `consumerPromise(Promise<T>)` のような関数をutil等として作成し、.catch+console.warnなどで処理せよ
- 各種のライブラリについて、最新情報をContext7を利用して検索せよ。

# Web

- 新しい実装をしたら必ず、Storybookの追加を検討せよ。

# TypeScript

- 関数型の手法を全面的に利用
- 参照等価性、テスタビリティ、構造化、レイヤリングを意識
- イミュータブルな方法を取る。`readonly`を付ける。`ReadonlyArray<...>`を利用する。
- interfaceを利用しない。type objectを利用
- asをとにかく利用しない。
  - type guardの利用を検討する
  - const isSomething = () => ...のような関数を作る
- anyをとにかく利用しない

# テスト駆動

## t-wada推奨のテスト駆動開発

- テストファーストで開発を進める。実装の前にテストを書く
- テストは「Arrange-Act-Assert」パターンに従う
  - Arrange: テストの前提条件を準備
  - Act: テスト対象の処理を実行
  - Assert: 期待する結果を検証
- テストケース名は「何をテストしているか」が明確にわかる名前にする
  - 日本語でのテストケース名も推奨
  - 「〜の場合、〜すること」という形式で記述
- 三角測量（Triangulation）を活用
  - 最初は仮実装でテストを通す
  - 複数のテストケースを追加して、一般化した実装に導く
- テストは独立性を保つ
  - 各テストは他のテストに依存しない
  - テストの実行順序に依存しない
- テストのセットアップとクリーンアップは適切に行う
  - beforeEach/afterEachを活用
  - テスト間で状態を共有しない
- テストは高速に実行できるようにする
  - 外部依存はモックやスタブで置き換える
- レッド・グリーン・リファクタリングのサイクルを守る
  1. 失敗するテストを書く（レッド）
  2. テストを通す最小限の実装を行う（グリーン）
  3. コードをリファクタリングする（リファクタリング）
- テストコードも本番コードと同じ品質基準を適用
  - DRY原則を守る
  - 可読性を重視する
  - 適切な抽象化を行う
